{% extends "core/base.html" %}
{% load static %}

{% block content %}

<!-- üé® Estilos personalizados solo para esta p√°gina -->
<style>
  /* Estilo para encabezados de tabla con azul marino */
  .table-dark-blue thead th {
    background-color: #1b3a57; /* Azul elegante */
    color: white;
  }

  /* Celdas de contenido con fondo oscuro y texto claro */
  .table-dark-blue tbody tr td {
    color: white;
    background-color: #2c2c2c;
  }

  /* Ajuste visual para listado de cr√≠ticas */
  .criticas-list {
    margin-left: 20px;
  }

  /* Estados visuales claros para si se ha le√≠do o no */
  .leido-true {
    color: #28a745; /* Verde positivo */
    font-weight: bold;
  }

  .leido-false {
    color: #dc3545; /* Rojo negativo */
    font-weight: bold;
  }

  /* Barra de filtro estilizada */
  .filter-bar {
    margin-bottom: 15px;
    padding: 10px;
    background-color: #2c2c2c;
    border-radius: 5px;
    color: white;
  }
</style>

<!-- üìä Contenedor principal con tabla filtrable -->
<div class="container mt-4">
  
  <!-- üîç Barra de filtros por estado de lectura -->
  <div class="filter-bar d-flex align-items-center">
    <strong>LEIDO: </strong>
    <div class="form-check form-check-inline ms-3 mb-0">
      <input class="form-check-input" style="margin-left: 8px;" type="checkbox" id="filter-leido-si" checked onchange="filtrarTabla()">
      <label class="form-check-label" for="filter-leido-si">S√≠</label>
    </div>
    <div class="form-check form-check-inline mb-0">
      <input class="form-check-input" type="checkbox" id="filter-leido-no" checked onchange="filtrarTabla()">
      <label class="form-check-label" for="filter-leido-no">No</label>
    </div>
  </div>

  <!-- üìã Tabla de libros con datos din√°micos -->
  <table id="tabla-libros" class="table table-dark-blue table-striped table-bordered">
    <thead>
      <tr>
        <th>T√≠tulo</th>
        <th>Autor</th>
        <th>Le√≠do</th>
        <th>Cr√≠tica</th>
      </tr>
    </thead>
    <tbody>
      {% for libro in listado %}
        <!-- Fila identificable y con atributo data para filtrado -->
        <tr id="fila-{{ forloop.counter }}" data-leido="{{ libro.leido }}">
          <td>{{ libro.titulo }}</td>
          <td>{{ libro.autor }}</td>
          <td>
            <!-- Estado visual con colores claros -->
            {% if libro.leido %}
              <span class="leido-true">S√≠</span>
            {% else %}
              <span class="leido-false">No</span>
            {% endif %}
          </td>
          <td>
            <!-- Lista de cr√≠ticas con mensaje alternativo -->
            <ul class="criticas-list">
              {% if libro.criticas %}
                <li>{{ libro.criticas.contenido }}</li>
              {% else %}
                <li>No hay cr√≠ticas a√∫n.</li>
              {% endif %}
            </ul>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- ‚öôÔ∏è Script para filtrar filas seg√∫n estado de 'le√≠do' -->
<script>
  function filtrarTabla() {
    const mostrarSi = document.getElementById("filter-leido-si").checked;
    const mostrarNo = document.getElementById("filter-leido-no").checked;

    const filas = document.querySelectorAll("#tabla-libros tbody tr");

    filas.forEach(fila => {
      const esLeido = fila.getAttribute("data-leido") === "True";

      // Mostrar u ocultar fila seg√∫n estado seleccionado
      if ((esLeido && mostrarSi) || (!esLeido && mostrarNo)) {
        fila.style.display = "";  // Muestra la fila
      } else {
        fila.style.display = "none";  // Oculta la fila
      }
    });
  }
</script>

{% endblock %}